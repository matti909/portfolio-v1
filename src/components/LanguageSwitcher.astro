---
import { getLangFromUrl, getTranslatedPath } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const currentPath = Astro.url.pathname;

const esPath = getTranslatedPath(currentPath, 'es');
const enPath = getTranslatedPath(currentPath, 'en');
---

<div class="language-switcher">
  <a
    href={esPath}
    class:list={['lang-btn', { active: lang === 'es' }]}
    aria-label="EspaÃ±ol"
    aria-current={lang === 'es' ? 'page' : undefined}
  >
    ES
  </a>
  <span class="separator">/</span>
  <a
    href={enPath}
    class:list={['lang-btn', { active: lang === 'en' }]}
    aria-label="English"
    aria-current={lang === 'en' ? 'page' : undefined}
  >
    EN
  </a>
</div>

<style>
  .language-switcher {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-weight: 900;
    font-size: var(--text-base);
  }

  .lang-btn {
    padding: var(--space-sm) var(--space-md);
    border: 3px solid var(--border-color);
    background: var(--bg-color);
    text-decoration: none;
    color: var(--text-color);
    transition: all var(--transition-fast);
    font-weight: 900;
    text-transform: uppercase;
  }

  .lang-btn.active {
    background: var(--accent-primary);
    box-shadow: var(--shadow-small);
    color: var(--text-color);
  }

  /* Dark mode needs black text on bright background */
  [data-theme="dark"] .lang-btn.active {
    color: #000000;
  }

  .lang-btn:hover {
    transform: translate(-2px, -2px);
    box-shadow: var(--shadow-brutal);
  }

  .lang-btn:active {
    transform: translate(2px, 2px);
    box-shadow: none;
  }

  .separator {
    font-size: var(--text-xl);
    opacity: 0.3;
    font-weight: 900;
  }

  @media (max-width: 640px) {
    .lang-btn {
      padding: var(--space-xs) var(--space-sm);
      font-size: var(--text-sm);
    }
  }
</style>
